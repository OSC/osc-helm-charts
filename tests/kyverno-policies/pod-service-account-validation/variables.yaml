policies:
  - name: pod-service-account-validation
    rules:
      - name: pods-require-valid-service-account-uid
        values:
          uidMap.data.user-test: '1000'
      - name: pods-require-valid-service-account-gid
        values:
          gidMap.data.user-test: '1001'
      - name: fsgroup-require-valid-service-account-gid
        values:
          gidMap.data.user-test: '1001'
      - name: pods-service-account-authorized-for-groups
        values:
          userGIDMap.data.user-test: '["1000", "1001"]'
    resources:
      - name: pods-require-valid-service-account-uid-skip
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-uid-skip-op
        values:
          request.operation: DELETE
      - name: pods-require-valid-service-account-webservice-uid-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-uid-container-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-uid-init-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-uid-fail
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-uid-container-fail
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-uid-init-fail
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-gid-skip
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-gid-skip-op
        values:
          request.operation: DELETE
      - name: pods-require-valid-service-account-webservice-gid-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-gid-container-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-gid-init-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-gid-fail
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-gid-container-fail
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-webservice-gid-init-fail
        values:
          request.operation: CREATE
      - name: fsgroup-require-valid-service-account-gid-skip
        values:
          request.operation: CREATE
      - name: fsgroup-require-valid-service-account-webservice-gid-skip-op
        values:
          request.operation: DELETE
      - name: fsgroup-require-valid-service-account-webservice-gid-pass
        values:
          request.operation: CREATE
      - name: fsgroup-require-valid-service-account-webservice-gid-fail
        values:
          request.operation: CREATE
      - name: test-groups-webservice-skip
        values:
          request.operation: CREATE
      - name: test-groups-webservice-skip-op
        values:
          request.operation: DELETE
      - name: test-groups-webservice-skip-len
        values:
          request.operation: CREATE
      - name: test-groups-webservice-pass
        values:
          request.operation: CREATE
      - name: test-groups-webservice-fail
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-uid-skip-op
        values:
          request.operation: DELETE
      - name: pods-require-valid-service-account-paas-uid-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-uid-container-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-uid-init-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-uid-fail
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-uid-container-fail
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-uid-init-fail
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-gid-skip-op
        values:
          request.operation: DELETE
      - name: pods-require-valid-service-account-paas-gid-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-gid-container-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-gid-init-pass
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-gid-fail
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-gid-container-fail
        values:
          request.operation: CREATE
      - name: pods-require-valid-service-account-paas-gid-init-fail
        values:
          request.operation: CREATE
      - name: fsgroup-require-valid-service-account-gid-skip
        values:
          request.operation: CREATE
      - name: fsgroup-require-valid-service-account-paas-gid-skip-op
        values:
          request.operation: DELETE
      - name: fsgroup-require-valid-service-account-paas-gid-pass
        values:
          request.operation: CREATE
      - name: fsgroup-require-valid-service-account-paas-gid-fail
        values:
          request.operation: CREATE
      - name: test-groups-paas-skip
        values:
          request.operation: CREATE
      - name: test-groups-paas-skip-op
        values:
          request.operation: DELETE
      - name: test-groups-paas-skip-len
        values:
          request.operation: CREATE
      - name: test-groups-paas-pass
        values:
          request.operation: CREATE
      - name: test-groups-paas-fail
        values:
          request.operation: CREATE
namespaceSelector:
  - name: user-test
    labels:
      foo: bar
  - name: webservice
    labels:
      osc.edu/role: webservice
  - name: paas
    labels:
      osc.edu/role: paas
